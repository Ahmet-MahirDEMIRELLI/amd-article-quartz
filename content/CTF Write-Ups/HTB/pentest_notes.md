---
title: Pentest Notes
tags:
  - htb
  - easy
---

#### Author: AMD

![[static/pentest_notes/pentest_notes.png]]

This is a writeup for <b>Pentest Notes</b> machine.

My target IP: 94.237.55.43:58467

-----------------------------------------------------------------------------------
<b>VISIT WEBSITE</b>

Lets register then login.

![[static/pentest_notes/home.png]]

If we click on the card we can see some details about them.

Lets catch the request with Burp Suite to take a closer look.

-----------------------------------------------------------------------------------
<b>BURP SUITE</b>

Lets click on the SQL Injection card.

![[static/pentest_notes/get.png]]

![[static/pentest_notes/get_response.png]]

We have a POST request detail in the answer. Lets look at the source code.

After forwarding the get response post details drops to burpsuite. Lets send it to repeater.

![[static/pentest_notes/post.png]]

-----------------------------------------------------------------------------------
<b>SOURCE CODE</b>

If we look at the application.properties we can see the system uses H2 in-memory database.

![[static/pentest_notes/application_properties.png]]

If we look at he NotesController.java we can see the POST requests details.

![[static/pentest_notes/notes_controller.png]]

-----------------------------------------------------------------------------------
<b>USING POST</b>

Lets try post method.

![[static/pentest_notes/post_answer.png]]

It returns 200. Now lets find a payload for H2 in-memory database.

-----------------------------------------------------------------------------------
<b>RESEARCH</b>

![[static/pentest_notes/h2_injection.png]]

-----------------------------------------------------------------------------------
<b>INJECTION</b>

Lets use it.

![[static/pentest_notes/injection_part1.png]]

![[static/pentest_notes/injection_part2.png]]

-----------------------------------------------------------------------------------
<b>GET THE FLAG</b>

If we exemine Dockerfile we can see that "RUN FLAG_NAME=$(head /dev/urandom | tr -dc A-Za-z0-9 | head -c 12) && mv /flag.txt "/${FLAG_NAME}_flag.txt"" flag names calculation. Lets try ls first.

![[static/pentest_notes/ls.png]]

We can see that flag is in "JN8fe3XRqTYK_flag.txt". Lets read it.

![[static/pentest_notes/cat.png]]

-----------------------------------------------------------------------------------
